<!DOCTYPE html>
<html>
<head>
    <title>Symptom Girl</title>
    <style type="text/css">
        .main {
            position: relative;
            border: 1px solid black;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 800px;
        }

        .container {
            width: 40%;
            height: 80%;
            background-image: url("img/avatar1.png");
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            border: 1px solid black;
            position: relative;
        }

        .hide {
            display: none;
        }

        .selector {
            background-color: #FADADD;
            width: 90%;
            height: 18%;
            position: absolute;
            border: 1px solid black;
            opacity: 40%;
            left: 5%
        }
        
        .button {
            font-size: 2em;
        }

        .symptomscontainer {
            background-color: white;
            display: flex;
            flex-direction: column;
            border: 1px solid black;
            position: absolute;
            bottom: 0;
            height: 50%;
            width: 50%;
            justify-content: center;
            align-items: center;
        }

        #record {
            margin-top: 1em;
        }

        .recordButton {
            background: #FF6F61;
            border: 1px solid #FF6F61;
            border-radius: 6px;
            box-shadow: rgba(0, 0, 0, 0.1) 1px 2px 4px;
            box-sizing: border-box;
            color: #FFFFFF;
            cursor: pointer;
            display: inline-block;
            font-family: nunito,roboto,proxima-nova,"proxima nova",sans-serif;
            font-size: 2em;
            font-weight: 800;
            line-height: 16px;
            min-height: 40px;
            outline: 0;
            padding: 12px 14px;
            text-align: center;
            text-rendering: geometricprecision;
            text-transform: none;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
            vertical-align: middle;
        }

        .recordButton:hover,
        .recordButton:active {
            background-color: initial;
            background-position: 0 0;
            color: #FF6F61;
        }

        .recordButton:active {
            opacity: .5;
        }

        .symptomrow {
            display: flex;
            padding: 0.5em 0em 0.5em 0em;
            border-bottom: 2px solid #F7E7CE;
        }

        .symptomrow .checkbox {
            border: 2px solid #E4BC58;
            border-radius: 5px;
            width: 1.5em;
            height: 1.5em;
            margin: 0px 10px 0px 0px;
        }

        .symptomrow .checkbox-active {
            border: 2px solid #E4BC58;
            border-radius: 5px;
            width: 1.5em;
            height: 1.5em;
            margin: 0px 10px 0px 0px;
            background-color: #F7E7CE;
        }

        .symptomrow .label {
            font-size: 1.5em;
        }
    </style>

    <script type="text/javascript">
		// Symptom map that connects symptoms to regions. Contents of this
		// can dynamically change.
		// NOTE: This is not the full JSON. Will be updated once symptoms are finalized.
		const symptomMap = {
			"region1" : [
				{"value":"fatigue", "text":"Fatigue"},
				{"value":"snoring", "text":"Snoring"},
				{"value":"poor_sleep", "text":"Poor Sleep"},
				{"value":"headache", "text":"Headache"}
			],
			"region2" : [
				{"value":"vomiting", "text":"Vomiting"},
				{"value":"dry_mouth", "text":"Dry Mouth"},
				{"value":"smell_change", "text":"Smell Change"}
			]
		};

		// This array holds the values of the active symptoms recorded.
        let activeSymptoms = [];

        function showSymptoms(id) {
			const region = symptomMap[id];
			const holder = document.getElementById('scontainer');
			scontainer.style = "display:inline";
			let innerHTML = "";
			for (const spair of region) {
				const val = spair['value'];
				const text = spair['text'];
				innerHTML += "<div class='symptomrow' onClick=\"symptomclicked('"+val+"');\"><div id='"+val+"' class='checkbox'></div><div class='label'>"+text+"</div></div>"
			}
			scontainer.innerHTML = innerHTML;
        }

        function submitForm(id) {
            const formDiv = document.getElementById("symptoms"+id);
            formDiv.style = "display:none";
        }

        function record() {
			/*
            const symptomList = ["symptom1", "symptom2", "symptom3", "symptom4", "symptom5", 
                           "symptom6", "symptom7", "symptom8", "symptom9", "symptom10", 
                           "symptom11", "symptom12", "symptom13", "symptom14", "symptom15", 
                           "symptom16", "symptom17", "symptom18", "symptom19", "symptom20", 
                           "symptom21", "symptom22", "symptom23", "symptom24", "symptom25"];
            let symptomTracker = new Object();
            for (let str of symptomList) {
                symptomTracker[str] = false;
            }
            for (let i = 1; i<=5; i++) {
                let form = document.getElementById("symptomForm" + i);
                let formData = new FormData(form);
                for (let [key, value] of formData.entries()) {
                    symptomTracker[value] = true;
                }
            }
            console.log(JSON.stringify(symptomTracker))
			*/

			/* 
			 * TODO: MyDataHelps API for finishSurvey() will be called here and the active list of symptom
					values recorded will be sent to the the server as a JSON object.
			 */
        }

        function symptomclicked(symptomid) {
            const ele = document.getElementById(symptomid);
            // Toggle the checked state of the fake checkbox.
            if (ele.className == 'checkbox') {
				ele.className = 'checkbox-active';
            }
			else {
				ele.className = 'checkbox';
			}

			// TODO: Add logic to add the symptomid to the `activeSymptoms` array if it does not exist. If it does then remove it. 
        }
    </script>
</head>

<body>
    <div class="main">
        <div class="container">
			<!-- NOTE: This is going to change. We are moving to only 4 regions. -->
            <div id="sel-1" class="selector" style="top:0%" onClick="showSymptoms('region1');"></div>
            <div id="sel-2" class="selector" style="top:20%" onClick="showSymptoms('region2');"></div>
            <div id="sel-3" class="selector" style="top:40%" onClick="showSymptoms('region3');"></div>
            <div id="sel-4" class="selector" style="top:60%" onClick="showSymptoms('region4');"></div>
            <div id="sel-5" class="selector" style="top:80%" onClick="showSymptoms('region5');"></div>
        </div>
        <div id="record">
            <input type="button" value="Record Symptoms" class="recordButton" onclick="record()"></input>
        </div>
        <div id="scontainer" class="symptomscontainer" style="display:none">
			<!-- The code inside the div is automatically populated when the div is clicked. -->
            <div class="symptomrow" onClick="symptomclicked('symptom1');">
                <div id="symptom1" class="checkbox"></div>
                <div class="label">Symptom 1</div>
            </div>
        </div>
		<div>
			<!-- TODO: Add the done button here and style it -->
			<!-- TODO: When this button is clicked called the `record()` method. 
		</div>
    </div>
</body>
</html>
